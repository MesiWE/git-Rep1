From type_one branch